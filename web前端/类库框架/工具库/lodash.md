## 官网

[官网](https://www.lodashjs.com/)

## Array

### \_.without(array, [values])

**描述：** 创建一个剔除所有给定值的新数组，剔除值的时候，使用 SameValueZero 做相等比较。

**参数：**

- array (Array): 要检查的数组。
- [values] (...\*): 要剔除的值。

**返回：**
(Array): 返回过滤值后的新数组。

```js
_.without([2, 1, 2, 3], 1, 2);
// => [3]
```

### \_.compact

**描述：** 创建一个新数组，包含原数组中所有的非假值元素。例如 false, null, 0, "", undefined, 和 NaN 都是被认为是“假值”。相当于 `array.filter(v => v)`

```js
_.compact([0, 1, false, 2, "", 3]);
// => [1, 2, 3]
```

### \_.sortBy

创建一个元素数组。 以 iteratee 处理的结果升序排序。 这个方法执行稳定排序，也就是说相同元素会保持原始排序。 iteratees 调用 1 个参数： (value)。

_.sortBy(collection, [iteratees=[_.identity]])

**参数：**

- collection (Array|Object): 用来迭代的集合。
- [iteratees=[_.identity]] (...(Array|Array[]|Function|Function[]|Object|Object[]|string|string[])): 这个函数决定排序。

```js
var users = [
  { user: "fred", age: 48 },
  { user: "barney", age: 36 },
  { user: "fred", age: 40 },
  { user: "barney", age: 34 },
];

_.sortBy(users, function (o) {
  return o.user;
});
// => objects for [['barney', 36], ['barney', 34], ['fred', 48], ['fred', 40]]

_.sortBy(users, ["user", "age"]);
// => objects for [['barney', 34], ['barney', 36], ['fred', 40], ['fred', 48]]

_.sortBy(users, "user", function (o) {
  return Math.floor(o.age / 10);
});
// => objects for [['barney', 36], ['barney', 34], ['fred', 48], ['fred', 40]]
```

### \_.fromPairs(pairs)

与\_.toPairs 正好相反；这个方法返回一个由键值对 pairs 构成的对象。
**参数：**

- pairs (Array): 键值对 pairs

```js
_.fromPairs([
  ["fred", 30],
  ["barney", 40],
]);
// => { 'fred': 30, 'barney': 40 }
```

## Object

### \_.mapKeys

```js
/**
 * The opposite of `mapValue` this method creates an object with the
 * same values as `object` and keys generated by running each own enumerable
 * string keyed property of `object` thru `iteratee`. The iteratee is invoked
 * with three arguments: (value, key, object).
 *
 * @since 3.8.0
 * @category Object
 * @param {Object} object The object to iterate over.
 * @param {Function} iteratee The function invoked per iteration.
 * @returns {Object} Returns the new mapped object.
 * @see mapValue
 * @example
 *
 * mapKey({ 'a': 1, 'b': 2 }, function(value, key) {
 *   return key + value
 * })
 * // => { 'a1': 1, 'b2': 2 }
 */
function mapKey(object, iteratee) {
  object = Object(object);
  const result = {};

  Object.keys(object).forEach((key) => {
    const value = object[key];
    result[iteratee(value, key, object)] = value;
  });
  return result;
}

export default mapKey;
```

### \_.mapValues

```js
/**
 * Creates an object with the same keys as `object` and values generated
 * by running each own enumerable string keyed property of `object` thru
 * `iteratee`. The iteratee is invoked with three arguments:
 * (value, key, object).
 *
 * @since 2.4.0
 * @category Object
 * @param {Object} object The object to iterate over.
 * @param {Function} iteratee The function invoked per iteration.
 * @returns {Object} Returns the new mapped object.
 * @see mapKeys
 * @example
 *
 * const users = {
 *   'fred':    { 'user': 'fred',    'age': 40 },
 *   'pebbles': { 'user': 'pebbles', 'age': 1 }
 * }
 *
 * mapValue(users, ({ age }) => age)
 * // => { 'fred': 40, 'pebbles': 1 } (iteration order is not guaranteed)
 */
function mapValue(object, iteratee) {
  object = Object(object);
  const result = {};

  Object.keys(object).forEach((key) => {
    result[key] = iteratee(object[key], key, object);
  });
  return result;
}

export default mapValue;
```

### \_.get

```js
_.get(props.record, 'instrumentList', [])) // null    若props.record.instrumentList为null则结果为null
```

[lodash 库\_.get 方法的实现走读](https://juejin.im/post/6844904005886279693)

#### get

```js
/**
 * Gets the value at `path` of `object`. If the resolved value is
 * `undefined`, the `defaultValue` is returned in its place.
 *
 * @since 3.7.0
 * @category Object
 * @param {Object} object The object to query. // 要检索的对象
 * @param {Array|string} path The path of the property to get. // 要获取属性的路径
 * @param {*} [defaultValue] The value returned for `undefined` resolved values. // 如果解析值是undefined，返回defaultValue
 * @returns {*} Returns the resolved value.
 * @see has, hasIn, set, unset
 * @example
 *
 * const object = { 'a': [{ 'b': { 'c': 3 } }] }
 *
 * get(object, 'a[0].b.c')
 * // => 3
 *
 * get(object, ['a', '0', 'b', 'c'])
 * // => 3
 *
 * get(object, 'a.b.c', 'default')
 * // => 'default'
 */
function get(object, path, defaultValue) {
  const result = object == null ? undefined : baseGet(object, path);
  return result === undefined ? defaultValue : result;
}
```

- object 为 null 时 result 是 undefined
- baseGet，实际实现也在 baseGet 中
- 第三个参数 defaultValue 即 result 为 undefined 时的默认值

#### baseGet

```js
/**
 * The base implementation of `get` without support for default values.
 *
 * @private
 * @param {Object} object The object to query.
 * @param {Array|string} path The path of the property to get.
 * @returns {*} Returns the resolved value.
 */
function baseGet(object, path) {
  path = castPath(path, object);

  let index = 0;
  const length = path.length;

  while (object != null && index < length) {
    object = object[toKey(path[index++])];
  }
  return index && index == length ? object : undefined;
}
```

- cashPath 实际上就是把字符串转成数组，如果传入的是数组就直接返回
- tokey 对 string 类型和 Symbol 类型的 key 和数字类型做一层处理
- 通过 while 读取传入的 path==>object 下的参数

#### castPath

```js
/**
 * Casts `value` to a path array if it's not one.
 *
 * @private
 * @param {*} value The value to inspect.
 * @param {Object} [object] The object to query keys on.
 * @returns {Array} Returns the cast property path array.
 */
function castPath(value, object) {
  if (Array.isArray(value)) {
    return value;
  }
  return isKey(value, object) ? [value] : stringToPath(value);
}
```

- isKey 判断 path 是不是当前对象的 key
- stringToPath 如果传入的 path 不是当前对象的 key，就调用该方法把字符串转成对应的数组

#### isKey

```js
/** Used to match property names within property paths. */
const reIsDeepProp = /\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/;
const reIsPlainProp = /^\w*$/;

/**
 * Checks if `value` is a property name and not a property path.
 *
 * @private
 * @param {*} value The value to check.
 * @param {Object} [object] The object to query keys on.
 * @returns {boolean} Returns `true` if `value` is a property name, else `false`.
 */
function isKey(value, object) {
  if (Array.isArray(value)) {
    return false;
  }
  const type = typeof value;
  if (
    type === "number" ||
    type === "boolean" ||
    value == null ||
    isSymbol(value)
  ) {
    return true;
  }
  return (
    reIsPlainProp.test(value) ||
    !reIsDeepProp.test(value) ||
    (object != null && value in Object(object))
  );
}
```

- reIsDeepProp 这个正则匹配 'a[0].b.c' 这类字符串
- value in Object(object) 就是遍历 value 在不在当前对象内
- isSymbol 判断当前对象是不是 symbol 类型 Object.prototype.toString.call

#### stringToPath

```js
const charCodeOfDot = ".".charCodeAt(0);
const reEscapeChar = /\\(\\)?/g;
const rePropName = RegExp(
  // Match anything that isn't a dot or bracket.
  "[^.[\\]]+" +
    "|" +
    // Or match property names within brackets.
    "\\[(?:" +
    // Match a non-string expression.
    "([^\"'][^[]*)" +
    "|" +
    // Or match strings (supports escaping characters).
    "([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2" +
    ")\\]" +
    "|" +
    // Or match "" as the space between consecutive dots or empty brackets.
    "(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))",
  "g"
);

/**
 * Converts `string` to a property path array.
 *
 * @private
 * @param {string} string The string to convert.
 * @returns {Array} Returns the property path array.
 */
const stringToPath = memoizeCapped((string) => {
  const result = [];
  if (string.charCodeAt(0) === charCodeOfDot) {
    result.push("");
  }
  string.replace(rePropName, (match, expression, quote, subString) => {
    let key = match;
    if (quote) {
      key = subString.replace(reEscapeChar, "$1");
    } else if (expression) {
      key = expression.trim();
    }
    result.push(key);
  });
  return result;
});
```

## 语言

### \_.isEmpty()

**描述：** 检查 value 是否为一个空对象，集合，映射或者 set

**返回：** 如果 value 为空，那么返回 true，否则返回 false。

```js
_.isEmpty(null);
// => true

_.isEmpty(true);
// => true

_.isEmpty(1);
// => true

_.isEmpty([1, 2, 3]);
// => false

_.isEmpty({ a: 1 });
// => false
```

## 数学

### \_.sumBy()

```js
var objects = [{ n: 4 }, { n: 2 }, { n: 8 }, { n: 6 }];

_.sumBy(objects, function (o) {
  return o.n;
});
// => 20

// The `_.property` iteratee shorthand.
_.sumBy(objects, "n");
// => 20
```

```js
// 实例
// const keys = ['deltaCash', 'vega', 'theta', 'rho', 'dailyPnl']
const getSum = (arr, keys) => {
  const a = keys.map((item) => [item, _.sumBy(arr, item)]);
  console.log("a :>> ", a);
  /* const a = [["deltaCash", 65192.66803882252], ["vega", 321.00375166734256], ["theta", -31.468940283980128]， ["rho", 321.57197868502607],["dailyPnl", -312.99954785678165]] */
  console.log("_.fromPairs(a) :>> ", _.fromPairs(a));
  /* const _.fromPairs(a) = {
    dailyPnl: -312.99954785678165,
    deltaCash: 65192.66803882252,
    rho: 321.57197868502607,
    theta: -31.468940283980128,
    vega: 321.00375166734256
  } */
  return _.fromPairs(a);
};
```
