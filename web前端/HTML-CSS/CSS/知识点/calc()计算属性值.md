# `calc()`计算属性值

## 定义

> `calc()`: 此 CSS 函数允许在声明 CSS 属性值时执行一些计算。它可以用在如下场合：`<length>、<frequency>, <angle>、<time>、<percentage>、<number>、或 <integer>`。

## 语法

此 calc() 函数用一个表达式作为它的参数，用这个表达式的结果作为值。这个表达式可以是任何如下操作符的组合，采用标准操作符处理法则的简单表达式。

- `+`: 加法。
- `-`: 减法。
- `*`: 乘法，乘数中至少有一个是 `<number>`。
- `/`: 除法，除数（/ 右面的数）必须是 `<number>`。

表达式中的运算对象可以使用任意 `<length>` 值。如果你愿意，你**可以在一个表达式中混用这类值的不同单位**。在需要时，你还可以使用小括号来建立计算顺序。

## 规则

- ==`+` 和 `-` **运算符的两边必须要有空白字符**==。
  比如，`calc(50% -8px)` 会被解析成为一个无效的表达式，解析结果是：一个百分比 后跟一个负数长度值。而加有空白字符的、有效的表达式 `calc(8px + -50%)` 会被解析成为：一个长度 后跟一个加号 再跟一个负百分比。

- `*` 和 `/` 这两个运算符前后不需要空白字符，但如果考虑到统一性，仍然推荐加上空白符。
- 用 0 作除数会使 HTML 解析器抛出异常。
- 涉及自动布局和固定布局的表格中的表列、表列组、表行、表行组和表单元格的宽度和高度百分比的数学表达式，`auto` 可视为已指定。
- `calc()` 函数支持嵌套，但支持的方式是：把被嵌套的 `calc()` 函数全当成普通的括号。（译者注：所以，函数内直接用括号就好了。）

## 实例

### 一：使用 CSS 变量嵌套使用 `calc()`

```css
.foo {
  --widthA: 100px;
  --widthB: calc(var(--widthA) / 2);
  --widthC: calc(var(--widthB) / 2);
  width: var(--widthC);
}
```

在所有的变量都被展开后，`widthC` 的值就会变成 `calc( calc( 100px / 2) / 2)`，然后，当它被赋值给 `.foo` 的 width 属性时，所有内部的这些 `calc()`（无论嵌套的有多深）都将会直接被扁平化为一个括号（原文：be flattened to just parentheses），所以这个 width 属性的值就直接相当于 `calc( ( 100px / 2) / 2)` 了，或者说就变成 25px 了。简而言之：**一个 `calc()` 里面的 `calc()` 就仅仅相当于是一个括号**。

### 二: 组合不同的单位

我们能够组合不同的单元。特别是，我们可以混合计算绝对单元（比如百分比与视口单元）与相对单元（比如像素）。例如，我们可以创造一个表达式，用一个百分比减掉一个像素值。

```css
.foo {
  /*表示宽度小于其父元素50px*/
  width: calc(100% - 50px);
}
```

### 三: 不同的单位运算例子

```css
.foo {
  width: calc(50vmax + 3rem);
  padding: calc(1vw + 1em);
  transform: rotate(calc(1turn + 28deg));
  background: hsl(100, calc(3 * 20%), 40%);
  font-size: calc(50vw / 3);
}
```

### 四：使得计算更加清晰

如果你使一组项目为它们父元素容器宽度的 1/6，你可能这么写：

```css
.foo {
  width: 16.666666667%;
}
```

然而，`calc`能够更加清晰并具有可读性：

```css
.foo {
  width: calc(100% / 6);
}
```

## 参考链接

- [MDN-calc()](https://developer.mozilla.org/zh-CN/docs/Web/CSS/calc)
- [CSS3 calc()是怎么实现计算](http://caibaojian.com/css3-calc.html)

# 实战

```css
/* 有时候用100%受到父元素影响不如vh方便 */
height: calc(100vh - 260px);
```
